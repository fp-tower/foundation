<!DOCTYPE html>
<html>
<head>
  <title>Analysis of global temperature</title>
  <meta charset="utf-8">
  <link rel="stylesheet" type="text/css" href="../style.css"/>
</head>
<body>
<textarea id="source">

background-image: url(../img/fp-tower/website-background.svg)

class: center, middle, white

.title[Analysis of global temperature]

---
# Data processing

<br>

<img src="../img/foundation/parlist-0a.svg" style="width:1000px;"/>

---
# Sequential iteration

<br>

<img src="../img/foundation/parlist-0b.svg" style="width:1000px;"/>

---
# Sequential iteration

<br>

<img src="../img/foundation/parlist-0c.svg" style="width:1000px;"/>

---
# Sequential iteration

<br>

<img src="../img/foundation/parlist-0d.svg" style="width:1000px;"/>

---
# Sequential iteration

<br>

<img src="../img/foundation/parlist-0e.svg" style="width:1000px;"/>

---
# Useful work

<br>

<img src="../img/foundation/parlist-0f.svg" style="width:1000px;"/>

---
# Partition the dataset

.center[
<img src="../img/foundation/parlist-1a.svg" style="width:1000px;"/>
]

---
# Partition the dataset

.center[
<img src="../img/foundation/parlist-1b.svg" style="width:1000px;"/>
]

---
# Partition the dataset

.center[
<img src="../img/foundation/parlist-1c.svg" style="width:1000px;"/>
]


---
# Partition the dataset

.center[
<img src="../img/foundation/parlist-1d.svg" style="width:1000px;"/>
]

---
# Partition the dataset

.center[
<img src="../img/foundation/parlist-1e.svg" style="width:1000px;"/>
]

---
# Partition the dataset


.center[
<img src="../img/foundation/parlist-2a.svg" style="width:1050px;"/>
]

---
# Size the partitions appropriately

.forty-seven-left[
<img src="../img/foundation/size-jobs.svg" alt="Find the right size for the job" style="width:400px;"/>
]

---
# Tasks may require different computing power

<img src="../img/foundation/parlist-2b.svg"  style="width:800px;"/>

---
# Tasks may require different computing power

<img src="../img/foundation/parlist-2c.svg"  style="width:800px;"/>

---
# Scales to more than one computer

<img src="../img/foundation/parlist-3.svg"  style="width:800px;"/>

---
# Important points

<br>

## 1. Size the partitions appropriately

## 2. Benchmark and tweak configuration for the task at hand

---
# Important points

<br>

## 1. Size the partitions appropriately

## 2. Benchmark and tweak configuration for the task at hand

## 3. Parallel process .hl2[MUST] produce the .hl2[SAME] result as the sequential one

---
background-image: url(../img/fp-tower/website-background-white.svg)

class: middle, white

# TemperatureNotebook.scala

---
background-image: url(../img/foundation/parlist-foldLeft-1.svg)

# foldLeft

---
background-image: url(../img/foundation/parlist-foldLeft-2a.svg)

# foldLeft per partition

---
background-image: url(../img/foundation/parlist-foldLeft-2b.svg)

# foldLeft per partition

---
background-image: url(../img/foundation/parlist-foldLeft-2c.svg)

# foldLeft per partition

---
background-image: url(../img/foundation/parlist-foldLeft-2d.svg)

# foldLeft per partition

---
background-image: url(../img/foundation/parlist-foldLeft-2e.svg)

# foldLeft per partition

---
background-image: url(../img/foundation/parlist-foldLeft-2f.svg)

# foldLeft per partition

---
background-image: url(../img/foundation/parlist-foldLeft-2g.svg)

# foldLeft per partition

---
background-image: url(../img/foundation/parlist-foldLeft-2h.svg)

# foldLeft per partition

---
background-image: url(../img/foundation/parlist-foldLeft-2i.svg)

# foldLeft per partition

---
background-image: url(../img/foundation/parlist-foldLeft-3a.svg)

# foldLeft per partition

---
background-image: url(../img/foundation/parlist-foldLeft-3b.svg)

# foldLeft per partition

---
background-image: url(../img/foundation/parlist-foldLeft-3c.svg)

# foldLeft per partition

---
background-image: url(../img/foundation/parlist-foldLeft-4.svg)

# All partitions folded

---
background-image: url(../img/foundation/parlist-foldLeft-5a.svg)

# foldLeft intermediate results

---
background-image: url(../img/foundation/parlist-foldLeft-5b.svg)

# foldLeft intermediate results

---
background-image: url(../img/foundation/parlist-foldLeft-5c.svg)

# foldLeft intermediate results

---
background-image: url(../img/foundation/parlist-foldLeft-5d.svg)

# foldLeft intermediate results

---
background-image: url(../img/foundation/parlist-foldLeft-5e.svg)

# foldLeft intermediate results

---
background-image: url(../img/foundation/parlist-foldLeft-5f.svg)

# foldLeft intermediate results

---
background-image: url(../img/foundation/parlist-foldLeft-6.svg)

# foldLeft

---
background-image: url(../img/fp-tower/website-background-white.svg)

class: middle, white

# TemperatureExercises.scala

---
background-image: url(../img/foundation/parlist-monofoldLeft-default-1.svg)

# monoFoldLeft vs List foldLeft

---
background-image: url(../img/foundation/parlist-monofoldLeft-default-2.svg)

# monoFoldLeft vs List foldLeft

---
class: center, middle

.thirty-seven-left[
# 0 + x == x

# x + 0 == x
]

--

.fifty-seven-right[
# combine(default, x) == x

# combine(x, default) == x
]

---
class: medium-code

# monoFoldLeft


<img src="../img/foundation/parlist-monofoldLeft-associative-1.svg" alt="foldLeft per partition" style="width:800px;"/>

---
class: medium-code

# monoFoldLeft

.thirty-two-left[
<img src="../img/foundation/parlist-monofoldLeft-associative-2.svg" alt="foldLeft per partition" style="width:250px;"/>
]

.sixty-seven-right[
<br><br>
```scala
val partition1  = combine(combine(default, 4), 7)
val partition2  = combine(default, 3)
val finalResult = combine(combine(default, partition1), partition2)
```
<br><br><br>
```scala
val partition1  = combine(default, 4)
val partition2  = combine(combine(default, 7), 3)
val finalResult = combine(combine(default, partition1), partition2)
```
]

---
class: medium-code

# monoFoldLeft

.thirty-two-left[
<img src="../img/foundation/parlist-monofoldLeft-associative-2.svg" alt="foldLeft per partition" style="width:250px;"/>
]

.sixty-seven-right[
<br><br>
```scala
val partition1  = combine(4, 7)
val partition2  = 3
val finalResult = combine(partition1, partition2)
```
<br><br><br>
```scala
val partition1  = 4
val partition2  = combine(7, 3)
val finalResult = combine(partition1, partition2)
```
]

---
# monoFoldLeft

.thirty-two-left[
<img src="../img/foundation/parlist-monofoldLeft-associative-2.svg" alt="foldLeft per partition" style="width:250px;"/>
]

.sixty-two-right[
<br><br><br>
```scala
combine(combine(4, 7), 3)
```
<br><br><br><br><br>
```scala
combine(4, combine(7, 3))
```
]

---
# Associative functions


<br><br><br>

.forty-seven-left[
```scala mdoc
(1 + (2 + 3)) == ((1 + 2) + 3)

(1 min (2 min 3)) == ((1 min 2) min 3)
```
]


---
background-image: url(../img/foundation/map-fold-1.svg)

# Sum Temperature

---
background-image: url(../img/foundation/map-fold-2.svg)

# Sum Temperature

---
background-image: url(../img/foundation/map-fold-3.svg)

# Sum Temperature

---
background-image: url(../img/foundation/map-fold-4.svg)

# Sum Temperature

---
background-image: url(../img/foundation/map-fold-5.svg)

# Sum Temperature

---
background-image: url(../img/foundation/parlist-foldMapPar-1a.svg)

# foldMap in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-1b.svg)

# foldMap in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-1c.svg)

# foldMap in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-1d.svg)

# foldMap in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-1e.svg)

# foldMap in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-1f.svg)

# foldMap in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-1g.svg)

# foldMap in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-1h.svg)

# foldMap in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-1i.svg)

# foldMap in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-2a.svg)

# foldMap in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-2b.svg)

# foldMap in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-2c.svg)

# foldMap in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-2d.svg)

# foldMap in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-2e.svg)

# foldMap in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-2f.svg)

# foldMap in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-2g.svg)

# foldMap in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-2h.svg)

# foldMap in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-2i.svg)

# foldMap in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-2j.svg)

# foldMap in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-3a.svg)

# foldMap intermediate results in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-3b.svg)

# foldMap intermediate results in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-3c.svg)

# foldMap intermediate results in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-3d.svg)

# foldMap intermediate results in parallel

---
background-image: url(../img/foundation/parlist-foldMapPar-4a.svg)

# foldMap intermediate results sequentially

---
background-image: url(../img/foundation/parlist-foldMapPar-4b.svg)

# foldMap intermediate results sequentially

---
background-image: url(../img/foundation/parlist-foldMapPar-4c.svg)

# foldMap intermediate results sequentially

---
background-image: url(../img/foundation/parlist-foldMapPar-4d.svg)

# foldMap intermediate results sequentially

---
background-image: url(../img/foundation/parlist-foldMapPar-4e.svg)

# foldMap intermediate results sequentially

---
background-image: url(../img/foundation/parlist-foldMapPar-4f.svg)

# foldMap intermediate results sequentially

---
background-image: url(../img/foundation/parlist-foldLeft-6.svg)

# foldMap

---
# Thread

```scala mdoc:silent
def createThread(n: Int): Thread = new Thread {
  override def run(): Unit =
    println(s"Thread ${n}")
}

val threads = 1.to(4).map(createThread)
```

```scala
threads.foreach(_.start())
// Thread 1
// Thread 3
// Thread 2
// Thread 4
```

---
# Executor and Runnable

.fifty-seven-left[
```scala mdoc:silent
import java.util.concurrent.Executors

val fixedPool = Executors.newFixedThreadPool(2)

def createRunnable(n: Int): Runnable =
  new Runnable {
    def run(): Unit =
      println(s"Runnable ${n}")
  }

val runnables = 1.to(4).map(createRunnable)
```


```scala
runnables.foreach(fixedPool.submit)
// Runnable 1
// Runnable 3
// Runnable 2
// Runnable 4
```
]

.thirty-seven-right[
<img src="../img/foundation/executor.svg" alt="Executor" style="width:400px;"/>
]

---
# Executor and Runnable

.fifty-seven-left[
```scala mdoc:reset:silent
import java.util.concurrent.Executors

val fixedPool = Executors.newFixedThreadPool(2)

def createRunnable(n: Int): Runnable =
  new Runnable {
    def run(): Unit = {
      val thread = Thread.currentThread
      println(s"[${thread.getName}] Runnable ${n}")
    }
  }

val runnables = 1.to(4).map(createRunnable)
```


```scala
runnables.foreach(fixedPool.submit)
// [pool-19-thread-1] Runnable 1
// [pool-19-thread-2] Runnable 3
// [pool-19-thread-1] Runnable 2
// [pool-19-thread-2] Runnable 4
```
]

.thirty-seven-right[
<img src="../img/foundation/executor.svg" alt="Executor" style="width:400px;"/>
]

---
# ExecutionContext and Future

```scala
import java.util.concurrent.Executors
import scala.concurrent.duration._
import scala.concurrent.{ Await, ExecutionContext, Future }

val fixedPool        = Executors.newFixedThreadPool(2)
val executionContext = ExecutionContext.fromExecutor(fixedPool)
```

```scala
val future = Future {
  Thread.sleep(1000)  // sleep 1 second
  1
}(executionContext)
// future: Future[Int] = Future(<not completed>)
```

---
# ExecutionContext and Future

```scala
import java.util.concurrent.Executors
import scala.concurrent.duration._
import scala.concurrent.{ Await, ExecutionContext, Future }

val fixedPool                 = Executors.newFixedThreadPool(2)
implicit val executionContext = ExecutionContext.fromExecutor(fixedPool)
```

```scala
val task = Future {
  Thread.sleep(1000)  // sleep 1 second
  3
}
// task: Future[Int] = Future(<not completed>)
```

--

```scala
Await.result(task, 2.minutes)
// res: Int = 3
```

---
# ExecutionContext and Future

```scala
import java.util.concurrent.Executors
import scala.concurrent.duration._
import scala.concurrent.{ Await, ExecutionContext, Future }

val fixedPool                 = Executors.newFixedThreadPool(2)
implicit val executionContext = ExecutionContext.fromExecutor(fixedPool)
```

```scala
val task = Future {
  Thread.sleep(1000 * 60 * 5)  // sleep 5 minutes
  3
}
// task: Future[Int] = Future(<not completed>)
```


```scala
Await.result(task, 2.minutes)
// java.util.concurrent.TimeoutException: Future timed out after [2 minutes]
```



---
# ExecutionContext and Future

```scala
import java.util.concurrent.Executors
import scala.concurrent.duration._
import scala.concurrent.{ Await, ExecutionContext, Future }

val fixedPool                 = Executors.newFixedThreadPool(2)
implicit val executionContext = ExecutionContext.fromExecutor(fixedPool)
```

```scala
val task = Future {
  Thread.sleep(1000 * 60 * 5)  // sleep 5 minutes
  3
}
// task: Future[Int] = Future(<not completed>)
```

```scala
Await.result(task, Duration.Inf)
// res: Int = 3
```

---
# ExecutionContext and Future

.fifty-seven-left[
<br><br><br>
```scala
val future1   = Future { task(1) }
val future2   = Future { task(2) }

val response1 = Await.result(future1, Duration.Inf)
val response2 = Await.result(future2, Duration.Inf)
```
]

.thirty-seven-right[.center[
<img src="../img/foundation/future-parallel.svg" alt="Future sequential" style="width:300px;"/>
]]

---
# ExecutionContext and Future

.fifty-seven-left[
<br><br><br>
```scala
val future1   = Future { task(1) }
val response1 = Await.result(future1, Duration.Inf)

val future2   = Future { task(2) }
val response2 = Await.result(future2, Duration.Inf)
```
]

.thirty-seven-right[.center[
<img src="../img/foundation/future-sequential.svg" alt="Future sequential" style="width:300px;"/>
]]




</textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>
    var slideshow = remark.create({
        ratio: "16:9",
        slideNumberFormat: ''
    });
</script>
</body>
</html>